<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Secure & Share Govt Docs</title>
  <link rel="stylesheet" href="css/styles.css"/>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-storage-compat.js"></script>
  <script src="js/firebaseConfig.js"></script>
  <script src="js/logger.js"></script>
  <script src="js/otpMock.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/db.js"></script>
  <script src="js/storage.js"></script>
  <script src="js/sharing.js"></script>
</head>
<body>
<header class="app-header">
  <h1>Secure & Share Govt Documents</h1>
  <nav>
    <a href="index.html">Home</a>
    <a href="dashboard.html">Dashboard</a>
    <a href="upload.html">Upload</a>
    <a href="share.html">Share</a>
    <a href="profile.html">Profile</a>
    <button id="logoutBtn" class="btn--ghost">Logout</button>
  </nav>
</header>
<main class="container">

<section class="card narrow">
  <h2>My Profile</h2>
  <div id="profileBox"></div>
  <button id="saveProfile" class="btn">Save</button>
</section>
<script>
  Auth.requireAuth();
  async function load(){ 
    const p = await DB.getProfile();
    const name = p?.name || '';
    const aadhaar = p?.aadhaar || '';
    document.getElementById('profileBox').innerHTML = `
      <label>Name <input id='pName' value='\${name}'></label>
      <label>Aadhaar (demo) <input id='pAadhaar' value='\${aadhaar}'></label>`;
  }
  load();
  document.getElementById('saveProfile').addEventListener('click', async ()=>{
    const name = document.getElementById('pName').value;
    const aadhaar = document.getElementById('pAadhaar').value;
    try{ await DB.updateProfile({name, aadhaar}); UI.flash('Profile saved'); }
    catch(e){ UI.flash(e.message,'error'); }
  });
</script>

</main>
<footer class="app-footer">Â© 2025 Secure & Share</footer>
<script>
  document.getElementById('logoutBtn')?.addEventListener('click', async ()=>{
    try{ await Auth.logout(); UI.flash('Logged out'); location.href='login.html'; }catch(e){ UI.flash(e.message,'error'); }
  });
</script>
</body>
</html>
