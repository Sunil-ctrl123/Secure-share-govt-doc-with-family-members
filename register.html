<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Secure & Share Govt Docs</title>
  <link rel="stylesheet" href="css/styles.css"/>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-storage-compat.js"></script>
  <script src="js/firebaseConfig.js"></script>
  <script src="js/logger.js"></script>
  <script src="js/otpMock.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/db.js"></script>
  <script src="js/storage.js"></script>
  <script src="js/sharing.js"></script>
</head>
<body>
<header class="app-header">
  <h1>Secure & Share Govt Documents</h1>
  <nav>
    <a href="index.html">Home</a>
    <a href="dashboard.html">Dashboard</a>
    <a href="upload.html">Upload</a>
    <a href="share.html">Share</a>
    <a href="profile.html">Profile</a>
    <button id="logoutBtn" class="btn--ghost">Logout</button>
  </nav>
</header>
<main class="container">

<section class="card narrow">
  <h2>Create Account</h2>
  <label>Name <input id="regName" required></label>
  <label>Aadhaar (demo) <input id="regAadhaar" required></label>
  <label>Email <input id="regEmail" type="email" required></label>
  <label>Password <input id="regPassword" type="password" required></label>
  <div class="otp-row">
    <button id="sendOtp" class="btn btn--secondary">Send OTP</button>
    <input id="otpInput" placeholder="Enter OTP"/>
  </div>
  <button id="regBtn" class="btn">Register</button>
</section>
<script>
document.getElementById('sendOtp').addEventListener('click', ()=>{
  const code = OTP.generate();
  UI.flash('Mock OTP generated. Check console.');
  console.log('OTP (demo):', code);
});
document.getElementById('regBtn').addEventListener('click', async ()=>{
  const name = document.getElementById('regName').value;
  const aadhaar = document.getElementById('regAadhaar').value;
  const email = document.getElementById('regEmail').value;
  const pass = document.getElementById('regPassword').value;
  const otp = document.getElementById('otpInput').value;
  try{ 
    if(!OTP.verify(otp)) throw new Error('Invalid OTP (demo)');
    await Auth.register(email, pass, name, aadhaar);
    UI.flash('Registration successful'); location.href='dashboard.html';
  }catch(e){ UI.flash(e.message,'error'); }
});
</script>

</main>
<footer class="app-footer">Â© 2025 Secure & Share</footer>
<script>
  document.getElementById('logoutBtn')?.addEventListener('click', async ()=>{
    try{ await Auth.logout(); UI.flash('Logged out'); location.href='login.html'; }catch(e){ UI.flash(e.message,'error'); }
  });
</script>
</body>
</html>
